
今天逛社区，发现一片讲的有关网页渲染的文章，浏览器从下载文档到显示文档是一个复杂的过程，并且各家浏览器引擎的工作原理略有差别，但是一般的步骤确实不约而同的。网上这种文章还是很多的，但是总是觉得看完还是有点迷糊。这篇译自Alexander Skutin 的文章讲的相关内容还是比较多的，很推荐~下面就自己理一理
 



## 浏览器是如何完成网页渲染？ ##

首先，我们一起来回顾一下网页渲染时，浏览器的动作：


- 根据来自服务器端的HTML代码形成文档对象模型（DOM）
- 加载并解析样式，形成CSS对象模型。
- 在文档对象模型和CSS对象模型之上，创建一棵由一组待生成渲染的对象组成的渲染树（在Webkit中这些对象被称为渲染器或渲染对象，而在Gecko中称之为“frame”。）渲染树反映了文档对象模型的结构，但是不包含诸如标签或含有display:none属性的不可见元素。在渲染树中，每一段文本字符串都表现为独立的渲染器。每一个渲染对象都包含与之对应的DOM对象，或者文本块，还加上计算过的样式。换言之，渲染树是一个文档对象模型的直观展示。
- 对渲染树上的每个元素，计算它的坐标，称之为布局。浏览器采用一种流方法，布局一个元素只需通过一次，但是表格元素需要通过多次。
- 最后，渲染树上的元素最终展示在浏览器里，这一过程称为“painting”。

当用户与网页交互，或者脚本程序改动修改网页时，前文提到的一些操作将会重复执行，因为网页的内在结构已经发生了改变。这时候就会涉及到重绘，重排：
## 重绘 ##

当改变那些不会影响元素在网页中的位置的元素样式时，譬如background-color(背景色)， border-color(边框色)， visibility(可见性)，浏览器只会用新的样式将元素重绘一次(这就是重绘，或者说重新构造样式)。重绘不会带来重新布局，并不一定伴随重排。

## 重排 ##

重排是一种更明显的改变，可以理解为渲染树需要重新计算，当改变影响到文本内容或结构，或者元素位置时，重排或者说重新布局就会发生。这些改变通常由以下事件触发：

- DOM操作（元素添加，删除，修改，或者元素顺序的改变）;
- 内容变化，包括表单域内的文本改变;
- CSS属性的计算或改变;
- 添加或删除样式表;
- 更改“类”的属性;
- 浏览器窗口的操作（缩放，滚动）;
- 伪类激活（：悬停）。

> 开发中，比较好的实践是尽量减少重排次数和缩小重排的范围，这其实也是在优化页面渲染

- 将多次改变样式的操作，整合为一次，巧妙地利用js中的“类”

  `$(this).addClass('has-transition');`

- 将多次需要重排元素的position设置为absolute或者fixed。这样这些元素就脱离了文档流，它的变化就不会影响其他元素。多用于动画的处理上
- 在内存中多次操作结点，完了再添加到文档中去。如异步获取表格数据，渲染到页面。可先获取数据在内存中构建html片段，在一次性添加到文档中
- 由于display：none的元素不在渲染树中，对隐藏的元素操作不会引发其他元素的重排。如果要对一个元素进行复杂的操作，可以先隐藏它，操作完后再显示。
- 在需要经常获取那些引起浏览器重排的属性时，要缓存到变量。

所以我们平时开发的时候还是要多注意，更多的时候性能还是比呈现出来更重要

想了解更多，大家可以戳一下链接：

[http://taligarsiel.com/Projects/howbrowserswork1.htm](http://taligarsiel.com/Projects/howbrowserswork1.htm)

[http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/](http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/)

